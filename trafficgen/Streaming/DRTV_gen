from selenium import webdriver
import time
from random import randint
from trafficgen.Streaming.capture import *
import _thread


def streamVideo(duration):
    browser.get('https://www.dr.dk/tv')
    # Choose random video
    videos = browser.find_elements_by_class_name('program-link')


    video = videos[randint(0,len(videos))]

    link = video.get_attribute('href')
    browser.get(link)

    time.sleep(1)
    play_button = browser.find_element_by_css_selector('button[title="Afspil"]')
    play_button.click()
    time.sleep(duration)

for i in range(5):
    # Open the chrome webdriver
    browser = webdriver.Chrome("C:\\Users\\arhjo\\OneDrive\\DTU\\Thesis\\classification-of-encrypted-traffic\\trafficgen\\Streaming\\chromedriver.exe")
    browser.minimize_window()
    #Specify duration in seconds
    duration = 60 * 5
    _thread.start_new_thread(captureTraffic,(1, duration, 'C:/users/arhjo/desktop/test', "DRTV"))

    streamVideo(duration)


    # Close browser
    browser.close()
